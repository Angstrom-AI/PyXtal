
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pyxtal.molecular_crystal module &#8212; PyXtal 0.1dev documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">PyXtal 0.1dev documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-pyxtal.molecular_crystal">
<span id="pyxtal-molecular-crystal-module"></span><h1>pyxtal.molecular_crystal module<a class="headerlink" href="#module-pyxtal.molecular_crystal" title="Permalink to this headline">¶</a></h1>
<p>Module for generation of random molecular crystals which meet symmetry
constraints. A pymatgen- or spglib-type structure object is created, which can
be saved to a .cif file. Options (preceded by two dashes) are provided for
command-line usage of the module:</p>
<blockquote>
<div><dl class="docutils">
<dt>spacegroup (-s): the international spacegroup number (between 1 and 230)</dt>
<dd>to be generated. In the case of a 2D crystal (using option ‘-d 2’),
this will instead be the layer group number (between 1 and 80).
Defaults to 36.</dd>
<dt>molecule (-e): the chemical formula of the molecule to use. For multiple</dt>
<dd>molecule types, separate entries with commas. Ex: “C60”, “H2O, CH4,
NH3”. Defaults to H2O</dd>
<dt>numMols (-n): the number of molecules in the PRIMITIVE unit cell (For</dt>
<dd>P-type spacegroups, this is the same as the number of molecules in the
conventional unit cell. For A, B, C, and I-centered spacegroups, this
is half the number of the conventional cell. For F-centered unit cells,
this is one fourth the number of the conventional cell.). For multiple
molecule types, separate entries with commas. Ex: “8”, “1, 4, 12”.
Defaults to 4</dd>
<dt>factor (-f): the relative volume factor used to generate the unit cell.</dt>
<dd>Larger values result in larger cells, with molecules spaced further
apart. If generation fails after max attempts, consider increasing this
value. Defaults to 3.0</dd>
<dt>verbosity (-v): the amount of information which should be printed for each</dt>
<dd>generated structure. For 0, only prints the requested and generated
spacegroups. For 1, also prints the Wyckoff positions and time elapsed.
For 2, also prints the contents of the generated pymatgen structure.
Defaults to 0</dd>
<dt>attempts (-a): the number of structures to generate. Note: if any of the</dt>
<dd>attempts fail, the number of generated structures will be less than this
value. Structures will be output to separate cif files. Defaults to 1</dd>
<dt>outdir (-o): the file directory where cif files will be output to. Defaults</dt>
<dd>to “out”</dd>
<dt>checkatoms (-c): whether or not to check inter-atomic distances at each step</dt>
<dd>of generation. When True, produces more accurate results, but requires
more computation time for larger molecules. When False, produces less
accurate results and may require a larger volume factor, but does not
require more computation time for large molecules. Generally, the flag
should only be set to False for large, approximately spherical molecules
like C60. Defaults to True</dd>
<dt>allowinversion (-i): whether or not to allow inversion of chiral molecules</dt>
<dd>for spacegroups which contain inversional and/or rotoinversional
symmetry. This should only be True if the chemical and biological
properties of the mirror molecule are known and suitable for the desired
application. Defaults to False</dd>
<dt>dimension (-d): 3 for 3D, or 2 for 2D. If 2D, generates a 2D crystal using</dt>
<dd>a layer group number instead of a space group number.</dd>
<dt>thickness (-t): The thickness, in Angstroms, to use when generating a</dt>
<dd>2D crystal. Note that this will not necessarily be one of the lattice
vectors, but will represent the perpendicular distance along the non-
periodic direction. Defaults to 2.0</dd>
</dl>
</div></blockquote>
<dl class="function">
<dt id="pyxtal.molecular_crystal.check_distance_molecular">
<code class="descclassname">pyxtal.molecular_crystal.</code><code class="descname">check_distance_molecular</code><span class="sig-paren">(</span><em>coord1</em>, <em>coord2</em>, <em>indices1</em>, <em>index2</em>, <em>lattice</em>, <em>radii</em>, <em>factor=1.0</em>, <em>PBC=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#check_distance_molecular"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.check_distance_molecular" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the distances between two set of molecules. The first set is generally
larger than the second. Distances between coordinates within the first set
are not checked, and distances between coordinates within the second set are
not checked. Only distances between points from different sets are checked.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first docutils">
<dt>coord1: multiple lists of fractional coordinates e.g. [[[.1,.6,.4],</dt>
<dd>[.3,.8,.2]],[[.4,.4,.4],[.3,.3,.3]]]</dd>
<dt>coord2: a list of new fractional coordinates e.g. [[.7,.8,.9],</dt>
<dd>[.4,.5,.6]]</dd>
<dt>indices1: the corresponding molecular indices of coord1, e.g. [1, 3].</dt>
<dd>Indices correspond to which value in radii to use</dd>
<dt>index2: the molecular index for coord2. Corresponds to which value in</dt>
<dd>radii to use</dd>
</dl>
<p>lattice: matrix describing the unit cell vectors
radii: a list of radii used to judge whether or not two molecules</p>
<blockquote>
<div>overlap</div></blockquote>
<dl class="docutils">
<dt>d_factor: the tolerance is multiplied by this amount. Larger values</dt>
<dd>mean molecules must be farther apart</dd>
</dl>
<p class="last">PBC: value to be passed to create_matrix for periodic boundary conditions</p>
</dd>
<dt>Returns:</dt>
<dd>a bool for whether or not the atoms are sufficiently far enough apart</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxtal.molecular_crystal.check_wyckoff_position_molecular">
<code class="descclassname">pyxtal.molecular_crystal.</code><code class="descname">check_wyckoff_position_molecular</code><span class="sig-paren">(</span><em>points</em>, <em>sg</em>, <em>orientations</em>, <em>wyckoffs=None</em>, <em>exact_translation=False</em>, <em>PBC=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#check_wyckoff_position_molecular"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.check_wyckoff_position_molecular" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of points, returns the index of the Wyckoff position within
the spacegroup.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">points: a list of 3d fractional coordinates or SymmOps to check
sg: the international space group number to check
wyckoffs: a list of (unsorted) Wyckoff positions obtained from</p>
<blockquote>
<div>get_wyckoffs.</div></blockquote>
<dl class="last docutils">
<dt>exact_translation: whether we require two SymmOps to have exactly equal</dt>
<dd>translational components. If false, translations related by +-1 are
considered equal</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>a single index corresponding to the detected Wyckoff position. If no
valid Wyckoff position is found, returns False</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxtal.molecular_crystal.choose_wyckoff_molecular">
<code class="descclassname">pyxtal.molecular_crystal.</code><code class="descname">choose_wyckoff_molecular</code><span class="sig-paren">(</span><em>wyckoffs</em>, <em>number</em>, <em>orientations</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#choose_wyckoff_molecular"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.choose_wyckoff_molecular" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose a Wyckoff position to fill based on the current number of molecules
needed to be placed within a unit cell</p>
<p>Rules:</p>
<blockquote>
<div><ol class="arabic simple">
<li>The new position’s multiplicity is equal/less than (number).</li>
<li>We prefer positions with large multiplicity.</li>
<li>The site must admit valid orientations for the desired molecule.</li>
</ol>
</div></blockquote>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">wyckoffs: an unsorted list of Wyckoff positions
number: the number of molecules still needed in the unit cell
orientations: the valid orientations for a given molecule. Obtained</p>
<blockquote class="last">
<div>from get_sg_orientations, which is called within molecular_crystal</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd>a single index for the Wyckoff position. If no position is found,
returns False</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxtal.molecular_crystal.estimate_volume_molecular">
<code class="descclassname">pyxtal.molecular_crystal.</code><code class="descname">estimate_volume_molecular</code><span class="sig-paren">(</span><em>numMols</em>, <em>boxes</em>, <em>factor=2.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#estimate_volume_molecular"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.estimate_volume_molecular" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the volume needed for a molecular crystal conventional unit cell.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>numMols: A list with the number of each type of molecule
boxes: A list of bounding boxes for each molecule. Obtained from get_box
factor: a factor to multiply the final result by. Used to increase space
between molecules</dd>
<dt>Returns:</dt>
<dd>the estimated volume (in cubic Angstroms) needed for the unit cell</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxtal.molecular_crystal.get_box">
<code class="descclassname">pyxtal.molecular_crystal.</code><code class="descname">get_box</code><span class="sig-paren">(</span><em>mol</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#get_box"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.get_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a molecule, find a minimum orthorhombic box containing it.
Size is calculated using min and max x, y, and z values, plus the padding defined by the vdw radius
For best results, call oriented_molecule first.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>mol: a pymatgen Molecule object</dd>
<dt>Returns:</dt>
<dd>a list [x1,x2,y1,y2,z1,z2] where x1 is the relative displacement in
the negative x direction, x2 is the displacement in the positive x
direction, and so on</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxtal.molecular_crystal.get_sg_orientations">
<code class="descclassname">pyxtal.molecular_crystal.</code><code class="descname">get_sg_orientations</code><span class="sig-paren">(</span><em>mol</em>, <em>sg</em>, <em>allow_inversion=False</em>, <em>PBC=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#get_sg_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.get_sg_orientations" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the valid orientations for each Molecule and Wyckoff position.
Returns a list with 3 indices:</p>
<blockquote>
<div><p>index 1: the Wyckoff position’s 1st index (based on multiplicity)</p>
<p>index 2: the WP’s 2nd index (within the group of equal multiplicity)</p>
<p>index 3: the index of the valid orientation for the molecule/WP pair</p>
</div></blockquote>
<p>For example, self.valid_orientations[i][j] would be a list of valid
orientations for self.molecules[i], in the Wyckoff position
self.wyckoffs[i][j]</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">mol: a pymatgen Molecule object.
sg: the international spacegroup number
allow_inversion: whether or not to allow inversion operations for chiral</p>
<blockquote class="last">
<div>molecules</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd><dl class="first last docutils">
<dt>a list of operations orientation objects for each Wyckoff position. 1st</dt>
<dd>and 2nd indices correspond to the Wyckoff position</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxtal.molecular_crystal.merge_coordinate_molecular">
<code class="descclassname">pyxtal.molecular_crystal.</code><code class="descname">merge_coordinate_molecular</code><span class="sig-paren">(</span><em>coor</em>, <em>lattice</em>, <em>wyckoff</em>, <em>sg</em>, <em>tol</em>, <em>orientations</em>, <em>PBC=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#merge_coordinate_molecular"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.merge_coordinate_molecular" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="pyxtal.molecular_crystal.mol_site">
<em class="property">class </em><code class="descclassname">pyxtal.molecular_crystal.</code><code class="descname">mol_site</code><span class="sig-paren">(</span><em>mol</em>, <em>position</em>, <em>sg</em>, <em>wp_index</em>, <em>lattice</em>, <em>PBC=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#mol_site"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.mol_site" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class for storing molecular Wyckoff positions and orientations within
the molecular_crystal class. Each mol_site object represenents an
entire Wyckoff position, not necessarily a single molecule.</p>
<dl class="attribute">
<dt id="pyxtal.molecular_crystal.mol_site.PBC">
<code class="descname">PBC</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.mol_site.PBC" title="Permalink to this definition">¶</a></dt>
<dd><p>The periodic boundary condition direction</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.mol_site.letter">
<code class="descname">letter</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.mol_site.letter" title="Permalink to this definition">¶</a></dt>
<dd><p>The Wyckoff letter of the molecule’s Wyckoff position</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.mol_site.mol">
<code class="descname">mol</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.mol_site.mol" title="Permalink to this definition">¶</a></dt>
<dd><p>A Pymatgen molecule object</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.mol_site.multiplicity">
<code class="descname">multiplicity</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.mol_site.multiplicity" title="Permalink to this definition">¶</a></dt>
<dd><p>The multiplicity of the molecule’s Wyckoff position</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.mol_site.position">
<code class="descname">position</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.mol_site.position" title="Permalink to this definition">¶</a></dt>
<dd><p>Relative coordinates of the molecule’s center within the unit cell</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.mol_site.sg">
<code class="descname">sg</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.mol_site.sg" title="Permalink to this definition">¶</a></dt>
<dd><p>The international spacegroup number</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.mol_site.wp_index">
<code class="descname">wp_index</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.mol_site.wp_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Single index of the Wyckoff position within the spacegroup</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyxtal.molecular_crystal.molecular_crystal">
<em class="property">class </em><code class="descclassname">pyxtal.molecular_crystal.</code><code class="descname">molecular_crystal</code><span class="sig-paren">(</span><em>sg</em>, <em>molecules</em>, <em>numMols</em>, <em>volume_factor</em>, <em>allow_inversion=False</em>, <em>orientations=None</em>, <em>check_atomic_distances=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#molecular_crystal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class for storing and generating molecular crystals based on symmetry
constraints. Based on the crystal.random_crystal class for atomic crystals.
Given a spacegroup, list of molecule objects, molecular stoichiometry, and
a volume factor, generates a molecular crystal consistent with the given
constraints. This crystal is stored as a pymatgen struct via self.struct</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">sg: The international spacegroup number
molecules: a list of pymatgen.core.structure.Molecule objects for</p>
<blockquote>
<div>each type of molecule</div></blockquote>
<dl class="last docutils">
<dt>numMols: A list of the number of each type of molecule within the</dt>
<dd>primitive cell (NOT the conventioal cell)</dd>
<dt>volume_factor: A volume factor used to generate a larger or smaller</dt>
<dd>unit cell. Increasing this gives extra space between molecules</dd>
<dt>allow_inversion: Whether or not to allow chiral molecules to be</dt>
<dd>inverted. If True, the final crystal may contain mirror images of
the original molecule. Unless the chemical properties of the mirror
image are known, it is highly recommended to keep this value False</dd>
<dt>orientations: Once a crystal with the same spacegroup and molecular</dt>
<dd>stoichiometry has been generated, you may pass its
valid_orientations attribute here to avoid repeating the
calculation, but this is not required</dd>
<dt>check_atomic_distances: If True, checks the inter-atomic distances</dt>
<dd>after each Wyckoff position is added. This requires slightly more
time, but vastly improves accuracy. For approximately spherical
molecules, or for large inter-molecular distances, this may be
turned off</dd>
</dl>
</dd>
</dl>
<dl class="method">
<dt id="pyxtal.molecular_crystal.molecular_crystal.Msgs">
<code class="descname">Msgs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#molecular_crystal.Msgs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.Msgs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal.allow_inversion">
<code class="descname">allow_inversion</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.allow_inversion" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not to allow chiral molecules to be inverted.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal.boxes">
<code class="descname">boxes</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.boxes" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of bounding boxes for each molecule. Used for estimating
volume of the unit cell.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal.check_atomic_distances">
<code class="descname">check_atomic_distances</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.check_atomic_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not inter-atomic distances are checked at each step.</p>
</dd></dl>

<dl class="method">
<dt id="pyxtal.molecular_crystal.molecular_crystal.check_compatible">
<code class="descname">check_compatible</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#molecular_crystal.check_compatible"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.check_compatible" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the number of molecules is compatible with the Wyckoff
positions. Considers the number of degrees of freedom for each Wyckoff
position, and makes sure at least one valid combination of WP’s exists.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal.factor">
<code class="descname">factor</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.factor" title="Permalink to this definition">¶</a></dt>
<dd><p>The supplied volume factor for the unit cell.</p>
</dd></dl>

<dl class="method">
<dt id="pyxtal.molecular_crystal.molecular_crystal.generate_crystal">
<code class="descname">generate_crystal</code><span class="sig-paren">(</span><em>max1=30</em>, <em>max2=30</em>, <em>max3=30</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#molecular_crystal.generate_crystal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.generate_crystal" title="Permalink to this definition">¶</a></dt>
<dd><p>The main code to generate a random molecular crystal. If successful,
stores a pymatgen.core.structure object in self.struct and sets
self.valid to True. If unsuccessful, sets self.valid to False and
outputs an error message.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>max1: the number of attempts for generating a lattice
max2: the number of attempts for a given lattice
max3: the number of attempts for a given Wyckoff position</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyxtal.molecular_crystal.molecular_crystal.get_orientations">
<code class="descname">get_orientations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#molecular_crystal.get_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.get_orientations" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the valid orientations for each Molecule and Wyckoff
position. Returns a list with 4 indices:</p>
<p>index 1: the molecular prototype’s index within self.molecules</p>
<p>index 2: the Wyckoff position’s 1st index (based on multiplicity)</p>
<p>index 3: the WP’s 2nd index (within the group of equal multiplicity)</p>
<p>index 4: the index of the valid orientation for the molecule/WP pair</p>
<p>For example, self.valid_orientations[i][j][k] would be a list of valid
orientations for self.molecules[i], in the Wyckoff position
self.wyckoffs[j][k]</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal.molecules">
<code class="descname">molecules</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of pymatgen.core.structure.Molecule objects, symmetrized and
oriented along their symmetry axes.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal.numMols">
<code class="descname">numMols</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.numMols" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of each type of molecule in the CONVENTIONAL cell</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal.radii">
<code class="descname">radii</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.radii" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of approximated radii for each molecule type. Used for
checking inter-molecular distances.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal.sg">
<code class="descname">sg</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.sg" title="Permalink to this definition">¶</a></dt>
<dd><p>The international spacegroup number of the crystal.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal.valid_orientations">
<code class="descname">valid_orientations</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.valid_orientations" title="Permalink to this definition">¶</a></dt>
<dd><p>The valid orientations for each molecule and Wyckoff position.
May be copied when generating a new molecular_crystal to save a
small amount of time</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal.volume">
<code class="descname">volume</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.volume" title="Permalink to this definition">¶</a></dt>
<dd><p>The volume of the generated unit cell</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal.wyckoffs">
<code class="descname">wyckoffs</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal.wyckoffs" title="Permalink to this definition">¶</a></dt>
<dd><p>The Wyckoff positions for the crystal’s spacegroup. Sorted by
multiplicity.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D">
<em class="property">class </em><code class="descclassname">pyxtal.molecular_crystal.</code><code class="descname">molecular_crystal_2D</code><span class="sig-paren">(</span><em>number</em>, <em>molecules</em>, <em>numMols</em>, <em>thickness</em>, <em>volume_factor</em>, <em>allow_inversion=False</em>, <em>orientations=None</em>, <em>check_atomic_distances=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#molecular_crystal_2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A 2d counterpart to molecular_crystal. Given a layer group, list of
molecule objects, molecular stoichiometry, and
a volume factor, generates a molecular crystal consistent with the given
constraints. This crystal is stored as a pymatgen struct via self.struct</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>number: the layer group number between 1 and 80. NOT equal to the</dt>
<dd>international space group number, which is between 1 and 230</dd>
<dt>molecules: a list of pymatgen.core.structure.Molecule objects for</dt>
<dd>each type of molecule</dd>
<dt>numMols: A list of the number of each type of molecule within the</dt>
<dd>primitive cell (NOT the conventioal cell)</dd>
<dt>thickness: the thickness, in Angstroms, of the unit cell in the 3rd</dt>
<dd>dimension (the direction which is not repeated periodically)</dd>
<dt>volume_factor: A volume factor used to generate a larger or smaller</dt>
<dd>unit cell. Increasing this gives extra space between molecules</dd>
<dt>allow_inversion: Whether or not to allow chiral molecules to be</dt>
<dd>inverted. If True, the final crystal may contain mirror images of
the original molecule. Unless the chemical properties of the mirror
image are known, it is highly recommended to keep this value False</dd>
<dt>orientations: Once a crystal with the same spacegroup and molecular</dt>
<dd>stoichiometry has been generated, you may pass its
valid_orientations attribute here to avoid repeating the
calculation, but this is not required</dd>
<dt>check_atomic_distances: If True, checks the inter-atomic distances</dt>
<dd>after each Wyckoff position is added. This requires slightly more
time, but vastly improves accuracy. For approximately spherical
molecules, or for large inter-molecular distances, this may be
turned off</dd>
</dl>
</dd>
</dl>
<dl class="method">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.Msgs">
<code class="descname">Msgs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#molecular_crystal_2D.Msgs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.Msgs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.PBC">
<code class="descname">PBC</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.PBC" title="Permalink to this definition">¶</a></dt>
<dd><p>The axis (between 1 and 3) which is not periodic.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.allow_inversion">
<code class="descname">allow_inversion</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.allow_inversion" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not to allow chiral molecules to be inverted.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.boxes">
<code class="descname">boxes</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.boxes" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of bounding boxes for each molecule. Used for estimating
volume of the unit cell.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.check_atomic_distances">
<code class="descname">check_atomic_distances</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.check_atomic_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not inter-atomic distances are checked at each step.</p>
</dd></dl>

<dl class="method">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.check_compatible">
<code class="descname">check_compatible</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#molecular_crystal_2D.check_compatible"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.check_compatible" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the number of molecules is compatible with the Wyckoff
positions. Considers the number of degrees of freedom for each Wyckoff
position, and makes sure at least one valid combination of WP’s exists.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.factor">
<code class="descname">factor</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.factor" title="Permalink to this definition">¶</a></dt>
<dd><p>The supplied volume factor for the unit cell.</p>
</dd></dl>

<dl class="method">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.generate_crystal">
<code class="descname">generate_crystal</code><span class="sig-paren">(</span><em>max1=30</em>, <em>max2=30</em>, <em>max3=30</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#molecular_crystal_2D.generate_crystal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.generate_crystal" title="Permalink to this definition">¶</a></dt>
<dd><p>The main code to generate a random molecular crystal. If successful,
stores a pymatgen.core.structure object in self.struct and sets
self.valid to True. If unsuccessful, sets self.valid to False and
outputs an error message.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>max1: the number of attempts for generating a lattice
max2: the number of attempts for a given lattice
max3: the number of attempts for a given Wyckoff position</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.get_orientations">
<code class="descname">get_orientations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxtal/molecular_crystal.html#molecular_crystal_2D.get_orientations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.get_orientations" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the valid orientations for each Molecule and Wyckoff
position. Returns a list with 4 indices:</p>
<p>index 1: the molecular prototype’s index within self.molecules</p>
<p>index 2: the Wyckoff position’s 1st index (based on multiplicity)</p>
<p>index 3: the WP’s 2nd index (within the group of equal multiplicity)</p>
<p>index 4: the index of the valid orientation for the molecule/WP pair</p>
<p>For example, self.valid_orientations[i][j][k] would be a list of valid
orientations for self.molecules[i], in the Wyckoff position
self.wyckoffs[j][k]</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.lgp">
<code class="descname">lgp</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.lgp" title="Permalink to this definition">¶</a></dt>
<dd><p>The number (between 1 and 80) for the crystal’s layer group.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.molecules">
<code class="descname">molecules</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of pymatgen.core.structure.Molecule objects, symmetrized and
oriented along their symmetry axes.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.numMols">
<code class="descname">numMols</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.numMols" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of each type of molecule in the CONVENTIONAL cell</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.radii">
<code class="descname">radii</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.radii" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of approximated radii for each molecule type. Used for
checking inter-molecular distances.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.sg">
<code class="descname">sg</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.sg" title="Permalink to this definition">¶</a></dt>
<dd><p>The number (between 1 and 230) for the international spacegroup.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.thickness">
<code class="descname">thickness</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.thickness" title="Permalink to this definition">¶</a></dt>
<dd><p>the thickness, in Angstroms, of the unit cell in the 3rd
dimension.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.valid_orientations">
<code class="descname">valid_orientations</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.valid_orientations" title="Permalink to this definition">¶</a></dt>
<dd><p>The valid orientations for each molecule and Wyckoff position.
May be copied when generating a new molecular_crystal to save a
small amount of time</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.volume">
<code class="descname">volume</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.volume" title="Permalink to this definition">¶</a></dt>
<dd><p>The volume of the generated unit cell</p>
</dd></dl>

<dl class="attribute">
<dt id="pyxtal.molecular_crystal.molecular_crystal_2D.wyckoffs">
<code class="descname">wyckoffs</code><em class="property"> = None</em><a class="headerlink" href="#pyxtal.molecular_crystal.molecular_crystal_2D.wyckoffs" title="Permalink to this definition">¶</a></dt>
<dd><p>The Wyckoff positions for the crystal’s spacegroup. Sorted by
multiplicity.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyxtal.molecular_crystal.rand">
<code class="descclassname">pyxtal.molecular_crystal.</code><code class="descname">rand</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyxtal.molecular_crystal.rand" title="Permalink to this definition">¶</a></dt>
<dd><p>random_sample(size=None)</p>
<p>Return random floats in the half-open interval [0.0, 1.0).</p>
<p>Results are from the “continuous uniform” distribution over the
stated interval.  To sample  multiply
the output of <cite>random_sample</cite> by <cite>(b-a)</cite> and add <cite>a</cite>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">random_sample</span><span class="p">()</span> <span class="o">+</span> <span class="n">a</span>
</pre></div>
</div>
<dl class="docutils">
<dt>size <span class="classifier-delimiter">:</span> <span class="classifier">int or tuple of ints, optional</span></dt>
<dd>Output shape.  If the given shape is, e.g., <code class="docutils literal"><span class="pre">(m,</span> <span class="pre">n,</span> <span class="pre">k)</span></code>, then
<code class="docutils literal"><span class="pre">m</span> <span class="pre">*</span> <span class="pre">n</span> <span class="pre">*</span> <span class="pre">k</span></code> samples are drawn.  Default is None, in which case a
single value is returned.</dd>
</dl>
<dl class="docutils">
<dt>out <span class="classifier-delimiter">:</span> <span class="classifier">float or ndarray of floats</span></dt>
<dd>Array of random floats of shape <cite>size</cite> (unless <code class="docutils literal"><span class="pre">size=None</span></code>, in which
case a single float is returned).</dd>
</dl>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span>
<span class="go">0.47108547995356098</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_sample</span><span class="p">())</span>
<span class="go">&lt;type &#39;float&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_sample</span><span class="p">((</span><span class="mi">5</span><span class="p">,))</span>
<span class="go">array([ 0.30220482,  0.86820401,  0.1654503 ,  0.11659149,  0.54323428])</span>
</pre></div>
</div>
<p>Three-by-two array of random numbers from [-5, 0):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_sample</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="mi">5</span>
<span class="go">array([[-3.99149989, -0.52338984],</span>
<span class="go">       [-2.99091858, -0.79479508],</span>
<span class="go">       [-1.23204345, -1.75224494]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyxtal.molecular_crystal.random">
<code class="descclassname">pyxtal.molecular_crystal.</code><code class="descname">random</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; x in the interval [0, 1).<a class="headerlink" href="#pyxtal.molecular_crystal.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pyxtal.molecular_crystal.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">PyXtal 0.1dev documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Qiang Zhu, Scott Fredericks.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>